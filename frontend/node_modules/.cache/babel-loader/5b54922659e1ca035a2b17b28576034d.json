{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Jeevi\\\\ttp-team-3-master\\\\src\\\\components\\\\views\\\\VerificationView.js\";\nimport React from 'react';\nimport { connect } from \"react-redux\";\nimport { addUserThunk, fetchAllUsersThunk } from \"../../thunks\";\n\nclass UploadFile extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.onFileChange = event => {\n      this.setState({\n        file: event.target.files[0]\n      });\n    };\n\n    this.uploadFileData = event => {\n      event.preventDefault();\n      this.setState({\n        message: ''\n      });\n      this.postFile();\n    };\n\n    this.validateUser = () => {\n      //check is the username length great than 5 and not duplicate username in database\n      const users = this.props.allUsers;\n      console.log(users);\n      const {\n        username\n      } = this.state;\n      let errors = { ...this.state.errors\n      };\n      let isValidName = true;\n\n      if (username.length < 5) {\n        isValidName = false;\n        errors.username = \"Invalid username, please enter more than 4 characters\";\n      }\n\n      for (let i = 0; i < users.length; i++) {\n        if (this.state.username === users[i].username) {\n          isValidName = false;\n          errors.username = \"Invalid username, duplicate name\";\n          break;\n        }\n      }\n\n      if (isValidName) {\n        this.props.addUser(this.state);\n        errors.username = \"valid username\";\n        return this.props.history.push(\"/verification\");\n      }\n\n      this.setState({\n        isValidName,\n        errors\n      });\n    };\n\n    this.handleSubmit = e => {\n      e.preventDefault();\n      this.validateUser();\n    };\n\n    this.state = {\n      file: '',\n      message: ''\n    };\n  }\n\n  postFile() {\n    var fileUpload;\n    let data = new FormData();\n    data.append('file', this.state.file);\n    console.log(this.state.file);\n    /*for(var pair of data.entries()){\r\n    \tconsole.log(pair[0]+','+pair[1]);\r\n    \tfileUpload += pair[1];\r\n    };*/\n\n    console.log(fileUpload); //\tvar ba_token=\"Bearer \"+token;\n\n    fetch(`http://localhost:8080/upload`, {\n      method: 'POST',\n      body: data,\n      headers: {\n        'Origin': 'http://localhost:8080'\n      }\n    }).then(response => {\n      this.setState({\n        message: \"File successfully uploaded\"\n      });\n    }).catch(err => {\n      this.setState({\n        error: err\n      });\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      id: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      className: \"form-signin\",\n      onSubmit: this.handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 5\n      }\n    }, \"Upload a File\"), /*#__PURE__*/React.createElement(\"h4\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 5\n      }\n    }, this.state.message), /*#__PURE__*/React.createElement(\"input\", {\n      onChange: this.onFileChange,\n      type: \"file\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 5\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      disabled: !this.state.file,\n      onClick: this.uploadFileData,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 5\n      }\n    }, \"Upload\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-primary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 5\n      }\n    }, \"Signup\")));\n  }\n\n}\n\nconst mapState = state => {\n  console.log(state);\n  return {\n    allUsers: state.allUsers\n  };\n};\n\nconst mapDispatch = (dispatch, ownProps) => {\n  return {\n    fetchAllUsers: () => dispatch(fetchAllUsersThunk()),\n    addUser: User => dispatch(addUserThunk(User, ownProps))\n  };\n};\n\nexport default connect(mapState, mapDispatch)(UploadFile);","map":{"version":3,"sources":["C:/Users/Jeevi/ttp-team-3-master/src/components/views/VerificationView.js"],"names":["React","connect","addUserThunk","fetchAllUsersThunk","UploadFile","Component","constructor","props","onFileChange","event","setState","file","target","files","uploadFileData","preventDefault","message","postFile","validateUser","users","allUsers","console","log","username","state","errors","isValidName","length","i","addUser","history","push","handleSubmit","e","fileUpload","data","FormData","append","fetch","method","body","headers","then","response","catch","err","error","render","mapState","mapDispatch","dispatch","ownProps","fetchAllUsers","User"],"mappings":"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","sourcesContent":["import React from 'react';\r\n\r\nimport { connect } from \"react-redux\";\r\n\r\nimport { addUserThunk,fetchAllUsersThunk } from \"../../thunks\";\r\nclass UploadFile extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {file: '', message: ''};\r\n\t}\r\n\t\r\n\tonFileChange = (event) => {\r\n\t\tthis.setState({\r\n\t\t\tfile: event.target.files[0]\r\n\t\t});\r\n\t}\r\n\t\r\n\tuploadFileData = (event) => {\r\n\t\tevent.preventDefault();\r\n\t\tthis.setState({message: ''});\r\n\t\t\r\n\t\t\r\n\t\t  this.postFile();\r\n\t  \r\n\t}\r\n\r\n\t\r\n\tvalidateUser = () => {\r\n\t\t//check is the username length great than 5 and not duplicate username in database\r\n\t\tconst users=this.props.allUsers;\r\n\t\tconsole.log(users)\r\n\t  const { username } = this.state;\r\n\t  let errors = { ...this.state.errors };\r\n\t  let isValidName = true;\r\n\t  if (username.length < 5) {\r\n\t\tisValidName = false;\r\n\t\terrors.username = \"Invalid username, please enter more than 4 characters\";\r\n\t  }\r\n\t  for(let i=0;i<users.length;i++){\r\n\t\tif(this.state.username===users[i].username){\r\n\t\t  isValidName = false;\r\n\t\t  errors.username = \"Invalid username, duplicate name\";\r\n\t\t break;\r\n\t   }\r\n\t }\r\n\t  if (isValidName) {\r\n\t\tthis.props.addUser(this.state)\r\n\t\terrors.username = \"valid username\";\r\n\t\treturn this.props.history.push(\"/verification\");\r\n\t  }\r\n\t  this.setState({ isValidName, errors });\r\n\t};\r\n\tpostFile(){\r\n\t\tvar fileUpload;\r\n\t\tlet data = new FormData();\r\n\t\tdata.append('file', this.state.file);\r\n\t\tconsole.log(this.state.file);\r\n\t\t/*for(var pair of data.entries()){\r\n\t\t\tconsole.log(pair[0]+','+pair[1]);\r\n\t\t\tfileUpload += pair[1];\r\n\t\t};*/\r\n\t\tconsole.log(fileUpload);\r\n\t//\tvar ba_token=\"Bearer \"+token;\r\n\t\tfetch(`http://localhost:8080/upload`, {\r\n\t\t\tmethod: 'POST',\r\n\t\t\tbody:data,\r\n\t\t\theaders:{\r\n\t\t\t\t'Origin':'http://localhost:8080',\r\n\r\n\t\t\t}\r\n\t\t}).then(response => {\r\n\r\n\t\t\tthis.setState({message: \"File successfully uploaded\"});\r\n\t\t}).catch(err => {\r\n\t\t\tthis.setState({error: err});\r\n\t\t});\r\n\r\n\t}\r\n\thandleSubmit = (e) => {\r\n\t\te.preventDefault();\r\n\t\tthis.validateUser();\r\n\t  };\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div id=\"container\">\r\n\t\t\t \r\n\t\t\t <form className=\"form-signin\" onSubmit={this.handleSubmit}>\r\n\t\t\t\t<h3>Upload a File</h3>\r\n\t\t\t\t<h4>{this.state.message}</h4>\r\n\t\t\t\t<input onChange={this.onFileChange} type=\"file\"></input>\r\n\t\t\t\t<button disabled={!this.state.file} onClick={this.uploadFileData}>Upload</button>\r\n\t\t\t\r\n\t\t\t\t<button className=\"btn btn-primary\" >Signup</button>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n\r\n}\r\n\r\nconst mapState = (state) => {\r\n\tconsole.log(state)\r\n\treturn {\r\n\t  allUsers: state.allUsers,\r\n\t};\r\n  };\r\n  const mapDispatch = (dispatch, ownProps) => {\r\n\treturn {\r\n\t  fetchAllUsers: () => dispatch(fetchAllUsersThunk()),\r\n\t  addUser: (User) => dispatch(addUserThunk(User, ownProps)),\r\n\t};\r\n  };\r\nexport default connect(mapState, mapDispatch)(UploadFile);"]},"metadata":{},"sourceType":"module"}